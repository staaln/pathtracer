{
    "collab_server" : "",
    "contents" : "setwd(\"/Users/stalenygard/prada\")\n\n#install.packages(c(\"magrittr\", \"digest\", \"reshape\", \"readr\", \"purrr\",\"dplyr\", \"tibble\", \"cli\", \"crayon\", \"stringr\"))\n#install.packages(\"/Users/stalenygard/prada/SomaLogic_ADat_Reader_SomaDataIO/SomaDataIO_2.3.1.tar.gz\", repos = NULL, type = \"source\")\nlibrary(SomaDataIO)\nlibrary(foreign)\ndata<-read.adat(\"/Users/stalenygard/prada/PRA-18-033_20180718/V4-18-033.hybNorm.medNormInt.plateScale.calibrate.medNormRefSMP.qcCheck.adat\")\n\n\nA<-as.matrix(data)\nB<-A[,-c(1:27)]\nBB<-matrix(0,nrow(B),ncol(B))\nfor(i in 1:nrow(B)) BB[i,]<-as.numeric(B[i,])\npca.res<-prcomp(log(BB),scale.=FALSE)\n#pca.res<-prcomp(dat2,scale.=TRUE)\n#pca.res<-prcomp(log(dat2))\n\npheno<-read.spss(\"PRADA_141218.sav\",to.data.frame=TRUE)\n\nptnr<-as.numeric(unlist(strsplit(as.character(pheno[,1]),\"p\"))[seq(2,nrow(pheno)*2,2)])\nmid<-gsub(\"1Y\",\"\",data$SampleId)\nmid[130]<-\"70A\"\nmid[282]<-\"44C\"\nmid[464]<-\"32D\"\nmatches <- regmatches(mid, gregexpr(\"[[:digit:]]+\", mid))\nmid2<-unlist(matches)\n\nix<-match(mid2,ptnr)\ngroup<-rep(0,nrow(data))\ngroup[which(pheno[ix,3]==0 & pheno[ix,4]==0)]<-1\ngroup[which(pheno[ix,3]==1 & pheno[ix,4]==0)]<-2\ngroup[which(pheno[ix,3]==0 & pheno[ix,4]==1)]<-3\ngroup[which(pheno[ix,3]==1 & pheno[ix,4]==1)]<-4\nca<-pheno[ix,3]\nbb<-pheno[ix,4]\n\n\ntid<-rep(10,nrow(data))\ntid[grep(\"A\",data[,6])]<-1\ntid[grep(\"B\",data[,6])]<-2\ntid[grep(\"C\",data[,6])]<-3\ntid[grep(\"D\",data[,6])]<-4\ntid[grep(\"1Y\",data[,6])]<-5\n\n\n\npca.res<-prcomp(BB,scale.=TRUE)\n\nix<-which(tid==3)\nplot(pca.res$x[ix,1],pca.res$x[ix,2],col=group[ix],main=\"Group\")\nplot(pca.res$x[ix,1],pca.res$x[ix,2],pch=group[-ix],col=tid[-ix],main=\"Group\")\n\n\nix<-which(group==4)\nscatterplot3d(pca.res$x[ix,1],pca.res$x[ix,2],pca.res$x[ix,3],pch=tid[ix],color=tid[ix],main=\"Group\",type=\"h\",xlab=\"PC1\",ylab=\"PC2\",zlab=\"PC3\")\n\n\n\n\n\n\n\npca.res<-prcomp(BB,scale.=TRUE)\n\nix<-grep(\"A\",data[,6])\nv<-unique(sort(as.numeric(mid2)))\n\np.a.b<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tV<-matrix(NA,length(v)-4,2)\n\tfor (i in 1:(length(v)-4)){\n\t\t#print(i)\n\t\tix1<-which(data$SampleId==paste(v[i],\"A\",sep=\"\"))\n\t\tix2<-which(data$SampleId==paste(v[i],\"B\",sep=\"\"))\n\t\tif(any(ix1) & any(ix2)) V[i,]<-BB[c(ix1,ix2),j]\n\t}\n\tp.a.b[j]<-t.test(log(V[,1]),log(V[,2]))$p.val\n}\n\np.b.c<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tV<-matrix(NA,length(v)-4,2)\n\tfor (i in (1:(length(v)-4))){\n\t\t#print(i)\n\t\tix1<-which(data$SampleId==paste(v[i],\"B\",sep=\"\"))\n\t\tix2<-which(data$SampleId==paste(v[i],\"C\",sep=\"\"))\n\t\tif(any(ix1) & any(ix2)) V[i,]<-BB[c(ix1,ix2),j]\n\t}\n\tp.b.c[j]<-t.test(log(V[,1]),log(V[,2]))$p.val\n}\n\np.c.d<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tV<-matrix(NA,length(v)-4,2)\n\tfor (i in 1:(length(v)-4)){\n\t\tix1<-which(data$SampleId==paste(v[i],\"C\",sep=\"\"))\n\t\tix2<-which(data$SampleId==paste(v[i],\"D\",sep=\"\"))\n\t\tif(any(ix1) & any(ix2)) V[i,]<-BB[c(ix1,ix2),j]\n\t}\n\tp.c.d[j]<-t.test(log(V[,1]),log(V[,2]))$p.val\n}\n\np.d.1y<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tV<-matrix(NA,length(v)-4,2)\n\tfor (i in 1:(length(v)-4)){\n\t\tix1<-which(data$SampleId==paste(v[i],\"D\",sep=\"\"))\n\t\tix2<-which(data$SampleId==paste(v[i],\"1Y\",sep=\" \"))\n\t\tif(any(ix1) & any(ix2)) V[i,]<-BB[c(ix1,ix2),j]\n\t}\n\tp.d.1y[j]<-t.test(log(V[,1]),log(V[,2]))$p.val\n}\n\npca.res<-prcomp(log(BB),scale.=TRUE)\n\npdf(\"prada-proteomics-plots-4.pdf\")\nplot(pca.res$x[,1],pca.res$x[,2],pch=20,col=as.numeric(as.factor(data[,7])),main=\"Type\")\nlegend(\"top\",c(\"Buffer\",\"Callibrator\",\"QC\",\"Sample\"),col=1:4,pch=20)\nplot(pca.res$x[,1],pca.res$x[,2],pch=20,col=as.numeric(data[,5]),main=\"Subarray\")\nlegend(\"top\",paste(\"Subarray\",1:8),col=1:8,pch=20)\nplot(pca.res$x[,1],pca.res$x[,2],pch=20,col=as.numeric(as.factor(data[,4])),main=\"Slide\")\nlegend(\"top\",paste(\"\",1:8),col=1:8,pch=20)\ncols=as.numeric(as.factor(as.character(data[,7])))\ncols[grep(\"A\",data[,6])]<-4\ncols[grep(\"B\",data[,6])]<-5\ncols[grep(\"C\",data[,6])]<-6\ncols[grep(\"D\",data[,6])]<-7\ncols[grep(\"1Y\",data[,6])]<-8\n#par(cex=0.7)\nplot(pca.res$x[,1],pca.res$x[,2],pch=20,col=group+1,main=\"Groups\")\n#par(cex=1)\nlegend(\"top\",c(\"Placebo, Placebo\",\"Candesartan, Placebo\",\"Placebo, Metoprolol\",\"Candesartan, Metoprolol\"),col=2:5,pch=20)\nplot(pca.res$x[,1],pca.res$x[,2],pch=20,col=cols,main=\"Timepoints\")\n#par(cex=1)\nlegend(\"top\",paste(\"timepoint\",1:5),col=4:8,pch=20)\nix<-which(group==0)\nv<-which.min(pca.res$x[,1])\nplot(pca.res$x[-c(ix),1],pca.res$x[-c(ix),2],pch=group[-c(ix)],col=cols[-c(ix)],main=\"Groups and timepoints, 2D\",xlab=\"PC1\",ylab=\"PC2\")\nlegend(\"topleft\",c(\"Placebo, Placebo\",\"Candesartan, Placebo\",\"Placebo, Metoprolol\",\"Candesartan, Metoprolol\"),col=1,pch=1:4,cex=0.7)\nlegend(\"top\",paste(\"timepoint\",1:5),col=4:8,cex=0.7,pch=20)\nscatterplot3d(pca.res$x[-c(ix),1],pca.res$x[-c(ix),2],pca.res$x[-c(ix),3],pch=group[-c(ix)],color=cols[-c(ix)],main=\"Groups and timepoints, 3D\",type=\"h\",xlab=\"PC1\",ylab=\"PC2\",zlab=\"PC3\")\nlegend(\"topleft\",c(\"Placebo, Placebo\",\"Candesartan, Placebo\",\"Placebo, Metoprolol\",\"Candesartan, Metoprolol\"),col=1,pch=1:4,cex=0.7)\nlegend(\"top\",paste(\"timepoint\",1:5),col=4:8,cex=0.7,pch=20)\nscatterplot3d(pca.res$x[-c(v,ix),1],pca.res$x[-c(v,ix),2],pca.res$x[-c(v,ix),3],pch=group[-c(v,ix)],color=cols[-c(v,ix)],main=\"Groups and timepoints, minus outlier\",type=\"h\",xlab=\"PC1\",ylab=\"PC2\",zlab=\"PC3\")\nlegend(\"topleft\",c(\"Placebo, Placebo\",\"Candesartan, Placebo\",\"Placebo, Metoprolol\",\"Candesartan, Metoprolol\"),col=1,pch=1:4,cex=0.7)\nlegend(\"top\",paste(\"timepoint\",1:5),col=4:8,cex=0.7,pch=20)\npar(mfrow=c(2,2))\nhist(p.a.b,100,main=\"Timepoint1 vs timepoint2\",ylim=c(0,1100))\npar(col=\"blue\")\nlegend(\"center\",paste(\"Number of significant proteins (fdr<0.1):\",length(which(p.adjust(p.a.b,\"fdr\")<0.1))),cex=0.7,col=\"blue\",bty=\"n\")\nhist(p.b.c,100,main=\"Timepoint2 vs timepoint3\",ylim=c(0,1100))\nlegend(\"center\",paste(\"Number of significant proteins (fdr<0.1):\",length(which(p.adjust(p.b.c,\"fdr\")<0.1))),cex=0.7,col=\"blue\",bty=\"n\")\nhist(p.c.d,100,main=\"Timepoint3 vs timepoint4\",ylim=c(0,1100))\nlegend(\"center\",paste(\"Number of significant proteins (fdr<0.1):\",length(which(p.adjust(p.c.d,\"fdr\")<0.1))),cex=0.7,col=\"blue\",bty=\"n\")\nhist(p.d.1y,100,main=\"Timepoint4 vs timepoint5\",ylim=c(0,1100))\nlegend(\"center\",paste(\"Number of significant proteins (fdr<0.1):\",length(which(p.adjust(p.d.1y,\"fdr\")<0.1))),cex=0.7,col=\"blue\",bty=\"n\")\ngraphics.off()\n\npheno[1:10,1:10]\nnames(pheno)\n\np.a.b<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tV<-matrix(NA,length(v)-4,2)\n\tfor (i in 1:(length(v)-4)){\n\t\t#print(i)\n\t\tix1<-which(data$SampleId==paste(v[i],\"A\",sep=\"\"))\n\t\tix2<-which(data$SampleId==paste(v[i],\"B\",sep=\"\"))\n\t\tif(any(ix1) & any(ix2)) V[i,]<-BB[c(ix1,ix2),j]\n\t}\n\tp.a.b[j]<-t.test(log(V[,1]),log(V[,2]))$p.val\n}\n\n\n\nix<-match(mid2,ptnr)\nfec<-rep(NA,nrow(data))\nfec.ix<-grep(\"FEC\",names(pheno))\nfec[which(pheno[ix,fec.ix]==1)]<-60*4\nfec[which(pheno[ix,fec.ix]==2)]<-60*6\nfec[which(pheno[ix,fec.ix]==3)]<-100*4\n\n\n\npdf(\"Placebo-placebo, unlogged, FEC (dose-response).pdf\")\npar(mfrow=c(3,2))\n\nix<-which(tid==1 & group==1)\nres.lm.1<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.lm.1[j]<-coef(summary(glm((BB[ix,j])~fec[ix])))[2,4]\n}\nhist(res.lm.1,100,main=\"Timepoint 1, Placebo-placebo, FEC (dose-response)\",cex.main=0.7)\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.1,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==2 & group==1)\nres.lm.2<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.lm.2[j]<-coef(summary(glm((BB[ix,j])~fec[ix])))[2,4]\n}\nhist(res.lm.2,100,main=\"Timepoint 2, Placebo-placebo, FEC (dose-response)\")\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.2,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==3 & group==1)\nres.lm.3<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.lm.3[j]<-coef(summary(glm((BB[ix,j])~fec[ix])))[2,4]\n}\nhist(res.lm.3,100,main=\"Timepoint 3, Placebo-placebo, FEC (dose-response)\")\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.3,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==4 & group==1)\nres.lm.4<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.lm.4[j]<-coef(summary(glm((BB[ix,j])~fec[ix])))[2,4]\n}\nhist(res.lm.4,100,main=\"Timepoint 4, Placebo-placebo, FEC (dose-response)\")\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.4,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==5 & group==1)\nres.lm.5<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.lm.5[j]<-coef(summary(glm((BB[ix,j])~fec[ix])))[2,4]\n}\nhist(res.lm.5,100,main=\"Timepoint 5, Placebo-placebo, FEC (dose-response)\")\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.5,\"fdr\")<0.2))),cex=0.7)\ngraphics.off()\n\n\npdf(\"Placebo-placebo, logged, FEC (dose-response).pdf\")\npar(mfrow=c(3,2))\nix<-which(tid==1 & group==1)\nres.lm.1<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.lm.1[j]<-coef(summary(glm(log(BB[ix,j])~fec[ix])))[2,4]\n}\nhist(res.lm.1,100,main=\"Timepoint 1, Placebo-placebo, FEC (dose-response)\",cex.main=0.7)\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.1,\"fdr\")<0.2))),cex=0.7)\nix<-which(tid==2 & group==1)\nres.lm.2<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.lm.2[j]<-coef(summary(glm(log(BB[ix,j])~fec[ix])))[2,4]\n}\nhist(res.lm.2,100,main=\"Timepoint 2, Placebo-placebo, FEC (dose-response)\")\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.2,\"fdr\")<0.2))),cex=0.7)\nix<-which(tid==3 & group==1)\nres.lm.3<-mid<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tmid[j]<-coef(summary(glm(log(BB[ix,j])~fec[ix])))[1,1]\n\tres.lm.3[j]<-coef(summary(glm(log(BB[ix,j])~fec[ix])))[2,4]\n}\nres.locfdr<-locfdr(res.lm.3[-which(mid<7)])\nfdr<-p.adjust(res.lm.3[-which(mid<7)],\"fdr\")\nsort(fdr)[1:10]\nwhich(fdr<0.5)\nhist(res.lm.3[-which(mid<7)],100)\n\n\nbb<-rep(NA,nrow(BB))\nca<-rep(NA,)\n\nR.f.7.a<-FDR.f.7.a<-list()\nfor (k in 1:5){\n\tix<-which(tid==k)\n\tres<-mid<-rep(NA,ncol(BB))\n\tfor (j in 1:ncol(BB)){\n\t\tprint(j)\n\t\tmid[j]<-coef(summary(glm(log(BB[ix,j])~fec[ix]+)))[1,1]\n\t\tres[j]<-coef(summary(glm(log(BB[ix,j])~fec[ix])))[2,4]\n\t}\n\t#res.locfdr<-locfdr(res[-which(mid<7)])\n\tR.f.7.a[[k]]<-res[-which(mid<7)]\n\tFDR.f.7.a[[k]]<-p.adjust(res[-which(mid<7)],\"fdr\")\t\n}\n\npar(mfrow=c(3,2))\nfor (k in 1:5) {\n\tprint(convest(R.f.7.a[[k]]))\n\thist(R.f.7.a[[k]],100)\n}\n\n\nF.res<-C.res<-B.res<-F.C.res<-F.B.res<-list()\nfor (k in 1:5){\n\tix<-which(tid==k)\n\tfec.res<-ca.res<-bb.res<-fec.ca.res<-fec.bb.res<-rep(NA,ncol(BB))\n\tfor (j in 1:ncol(BB)){\n\t\tprint(j)\n\t\tmidd<-coef(summary(glm(log(BB[ix,j])~fec[ix]*ca[ix]+fec[ix]*bb[ix])))\n\t\tfec.res[j]<-midd[2,3]\n\t\tca.res[j]<-midd[3,3]\n\t\tbb.res[j]<-midd[4,3]\n\t\tfec.ca.res[j]<-midd[5,3]\n\t\tfec.bb.res[j]<-midd[6,3]\n\t}\n\t#res.locfdr<-locfdr(res[-which(mid<7)])\n\tF.res[[k]]<-fec.res\n\tC.res[[k]]<-ca.res\n\tB.res[[k]]<-bb.res\n\tF.C.res[[k]]<-fec.ca.res\n\tF.B.res[[k]]<-fec.bb.res\n}\n\n\nF.res<-C.res<-B.res<-F.C.res<-F.B.res<-list()\nfor (k in 1:5){\n\tix<-which(tid==k)\n\tfec.res<-ca.res<-bb.res<-fec.ca.res<-fec.bb.res<-rep(NA,ncol(BB))\n\tfor (j in 1:ncol(BB)){\n\t\tprint(j)\n\t\tmidd<-coef(summary(glm(log(BB[ix,j])~fec[ix]*ca[ix]+fec[ix]*bb[ix])))\n\t\tfec.res[j]<-midd[2,3]\n\t\tca.res[j]<-midd[3,3]\n\t\tbb.res[j]<-midd[4,3]\n\t\tfec.ca.res[j]<-midd[5,3]\n\t\tfec.bb.res[j]<-midd[6,3]\n\t}\n\t#res.locfdr<-locfdr(res[-which(mid<7)])\n\tF.res[[k]]<-fec.res\n\tC.res[[k]]<-ca.res\n\tB.res[[k]]<-bb.res\n\tF.C.res[[k]]<-fec.ca.res\n\tF.B.res[[k]]<-fec.bb.res\n}\n\n\nres.fec.1<-res.fec.2<-res.fec.3<-res.fec.4<-res.fec.5<-\nres.fec.bb.1<-res.fec.bb.2<-res.fec.bb.3<-res.fec.bb.4<-res.fec.bb.5<-\nres.fec.ca.1<-res.fec.ca.2<-res.fec.ca.3<-res.fec.ca.4<-res.fec.ca.5<-\nres.ca.1<-res.ca.2<-res.ca.3<-res.ca.4<-res.ca.5<-rep(NA,nrow(BB))\nres.bb.1<-res.bb.2<-res.bb.3<-res.bb.4<-res.bb.5<-rep(NA,nrow(BB))\nix<-which(group==1 | group==2 | group==3 | group==4)\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tdat<-cbind(log(BB[ix,j]),fec[ix],as.factor(mid2)[ix],as.factor(tid[ix]),bb[ix],ca[ix])\n\tcolnames(dat)<-c(\"prot\",\"fec\",\"id\",\"tid\",\"bb\",\"ca\")\n\tdat<-data.frame(dat)\n\tdat[,3]<-as.factor(dat[,3])\n\tdat[,4]<-as.factor(dat[,4])\n\tdat[,5]<-as.factor(dat[,5])\n\tdat[,6]<-as.factor(dat[,6])\n\tmidd<-lme(prot~fec*tid*bb+fec*tid*ca,random=~1|as.factor(id),data=dat)\n\tres.fec.1[j]<-coef(summary(midd))[2,5]\n\tres.fec.2[j]<-coef(summary(midd))[9,5]\n\tres.fec.3[j]<-coef(summary(midd))[10,5]\n\tres.fec.4[j]<-coef(summary(midd))[11,5]\n\tres.fec.5[j]<-coef(summary(midd))[12,5]\t\n\tres.fec.bb.1[j]<-coef(summary(midd))[13,5]\n\tres.fec.bb.2[j]<-coef(summary(midd))[23,5]\n\tres.fec.bb.3[j]<-coef(summary(midd))[24,5]\n\tres.fec.bb.4[j]<-coef(summary(midd))[25,5]\n\tres.fec.bb.5[j]<-coef(summary(midd))[26,5]\t\n\tres.fec.ca.1[j]<-coef(summary(midd))[18,5]\n\tres.fec.ca.2[j]<-coef(summary(midd))[27,5]\n\tres.fec.ca.3[j]<-coef(summary(midd))[28,5]\n\tres.fec.ca.4[j]<-coef(summary(midd))[29,5]\n\tres.fec.ca.5[j]<-coef(summary(midd))[30,5]\t\n\tres.bb.1[j]<-coef(summary(midd))[7,5]\t\n\tres.bb.2[j]<-coef(summary(midd))[14,5]\n\tres.bb.3[j]<-coef(summary(midd))[15,5]\n\tres.bb.4[j]<-coef(summary(midd))[16,5]\n\tres.bb.5[j]<-coef(summary(midd))[17,5]\n\tres.ca.1[j]<-coef(summary(midd))[8,5]\n\tres.ca.2[j]<-coef(summary(midd))[19,5]\n\tres.ca.3[j]<-coef(summary(midd))[20,5]\n\tres.ca.4[j]<-coef(summary(midd))[21,5]\n\tres.ca.5[j]<-coef(summary(midd))[22,5]\t\n}\n\npdf(\"fec_log.pdf\")\npar(mfrow=c(3,2))\nylim=c(0,200)\nhist(res.fec.1,100,ylim=ylim)\nconvest(res.fec.1)\nhist(res.fec.2,100,ylim=ylim)\nconvest(res.fec.2)\nhist(res.fec.3,100,ylim=ylim)\nconvest(res.fec.3)\nhist(res.fec.4,100,ylim=ylim)\nconvest(res.fec.4)\nhist(res.fec.5,100,ylim=ylim)\nconvest(res.fec.5)\ngraphics.off()\n\npdf(\"fecXbb_log.pdf\")\npar(mfrow=c(3,2))\nylim=c(0,200)\nhist(res.fec.bb.1,100,ylim=ylim)\nconvest(res.fec.bb.1)\nhist(res.fec.bb.2,100,ylim=ylim)\nconvest(res.fec.bb.2)\nhist(res.fec.bb.3,100,ylim=ylim)\nconvest(res.fec.bb.3)\nhist(res.fec.bb.4,100,ylim=ylim)\nconvest(res.fec.bb.4)\nhist(res.fec.bb.5,100,ylim=ylim)\nconvest(res.fec.bb.5)\ngraphics.off()\n\npdf(\"fecXca_log.pdf\")\npar(mfrow=c(3,2))\nylim=c(0,200)\nhist(res.fec.ca.1,100,ylim=ylim)\nconvest(res.fec.ca.1)\nhist(res.fec.ca.2,100,ylim=ylim)\nconvest(res.fec.ca.2)\nhist(res.fec.ca.3,100,ylim=ylim)\nconvest(res.fec.ca.3)\nhist(res.fec.ca.4,100,ylim=ylim)\nconvest(res.fec.ca.4)\nhist(res.fec.ca.5,100,ylim=ylim)\nconvest(res.fec.ca.5)\ngraphics.off()\n\npdf(\"ca_log.pdf\")\npar(mfrow=c(3,2))\nylim=c(0,200)\nhist(res.ca.1,100,ylim=ylim)\nconvest(res.ca.1)\nhist(res.ca.2,100,ylim=ylim)\nconvest(res.ca.2)\nhist(res.ca.3,100,ylim=ylim)\nconvest(res.ca.3)\nhist(res.ca.4,100,ylim=ylim)\nconvest(res.ca.4)\nhist(res.ca.5,100,ylim=ylim)\nconvest(res.ca.5)\ngraphics.off()\n\npdf(\"bb_log.pdf\")\npar(mfrow=c(3,2))\nylim=c(0,200)\nhist(res.bb.1,100,ylim=ylim)\nconvest(res.bb.1)\nhist(res.bb.2,100,ylim=ylim)\nconvest(res.bb.2)\nhist(res.bb.3,100,ylim=ylim)\nconvest(res.bb.3)\nhist(res.bb.4,100,ylim=ylim)\nconvest(res.bb.4)\nhist(res.bb.5,100,ylim=ylim)\nconvest(res.bb.5)\ngraphics.off()\n\n\nwhich(res.fec.3<0.05 & res.bb.3<0.05)\nv<-which(res.fec.3<0.05 & res.bb.3<0.05 & res.fec.bb.3<0.05)\n\n\n\nfec.group<-as.factor(fec)\nind<-sort(unique(as.numeric(mid2)))\nix<-which(as.numeric(mid2)==ind[1])\no<-order(tid[ix])\nplot(tid[ix[o]],log(BB[ix[o],v[2]]),col=group[ix[o]]+1,pch=20,ylim=c(5,6))\nfor (i in 1:length(ind)){\n\tix<-which(as.numeric(mid2)==ind[i])\n\to<-order(tid[ix])\n\tif(group[ix[o[1]]]==1)\n\tlines(tid[ix[o]],(BB[ix[o],v[2]]),col=as.numeric(fec.group[ix[o[1]]]),pch=20)\n}\n\nres.fec.g1.1<-res.fec.g1.2<-res.fec.g1.3<-res.fec.g1.4<-res.fec.g1.5<-rep(NA,nrow(BB))\nix<-which(group==1)\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tdat<-cbind(log(BB[ix,j]),fec[ix],as.factor(mid2)[ix],as.factor(tid[ix]))\n\tcolnames(dat)<-c(\"prot\",\"fec\",\"id\",\"tid\")\n\tdat<-data.frame(dat)\n\tdat[,3]<-as.factor(dat[,3])\n\tdat[,4]<-as.factor(dat[,4])\n\tmidd<-lme(log(prot)~fec*tid,random=~1|as.factor(id),data=dat)\n\tres.fec.g1.1[j]<-coef(summary(midd))[2,5]\n\tres.fec.g1.2[j]<-coef(summary(midd))[3,5]\n\tres.fec.g1.3[j]<-coef(summary(midd))[4,5]\n\tres.fec.g1.4[j]<-coef(summary(midd))[5,5]\n\tres.fec.g1.5[j]<-coef(summary(midd))[6,5]\n}\npdf(\"fec_group1_log.pdf\")\npar(mfrow=c(3,2))\nylim=c(0,300)\nhist(res.fec.g1.1,100,ylim=ylim)\nconvest(res.fec.g1.1)\nhist(res.fec.g1.2,100,ylim=ylim)\nconvest(res.fec.g1.2)\nhist(res.fec.g1.3,100,ylim=ylim)\nconvest(res.fec.g1.3)\nhist(res.fec.g1.4,100,ylim=ylim)\nconvest(res.fec.g1.4)\nhist(res.fec.g1.5,100,ylim=ylim)\nconvest(res.fec.g1.5)\ngraphics.off()\n\nres.fec.all.1<-res.fec.all.2<-res.fec.all.3<-res.fec.all.4<-res.fec.all.5<-rep(NA,nrow(BB))\nix<-which(group==1 | group==2 | group==3 | group==4)\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tdat<-cbind(log(BB[ix,j]),fec[ix],as.factor(mid2)[ix],as.factor(tid[ix]))\n\tcolnames(dat)<-c(\"prot\",\"fec\",\"id\",\"tid\")\n\tdat<-data.frame(dat)\n\tdat[,3]<-as.factor(dat[,3])\n\tdat[,4]<-as.factor(dat[,4])\n\tif(j!=4374)\n\tmidd<-lme(prot~fec*tid,random=~1|as.factor(id),data=dat)\n\tres.fec.all.1[j]<-coef(summary(midd))[2,5]\n\tres.fec.all.2[j]<-coef(summary(midd))[3,5]\n\tres.fec.all.3[j]<-coef(summary(midd))[4,5]\n\tres.fec.all.4[j]<-coef(summary(midd))[5,5]\n\tres.fec.all.5[j]<-coef(summary(midd))[6,5]\n}\npdf(\"fec_allgroups_log.pdf\")\npar(mfrow=c(3,2))\nylim=c(0,300)\nhist(res.fec.all.1,100,ylim=ylim)\nconvest(res.fec.all.1)\nhist(res.fec.all.2,100,ylim=ylim)\nconvest(res.fec.all.2)\nhist(res.fec.all.3,100,ylim=ylim)\nconvest(res.fec.all.3)\nhist(res.fec.all.4,100,ylim=ylim)\nconvest(res.fec.all.4)\nhist(res.fec.all.5,100,ylim=ylim)\nconvest(res.fec.all.5)\ngraphics.off()\n\n\npdf(\"p-val-histograms.pdf\")\npar(mfrow=c(1,2))\nhist(res.fec.g1.1,100,ylim=ylim,main=\"Timepoint1, Placebo_placebo group\",xlab=\"P-val for FEC effect\",cex.main=0.8)\nn.sig<-length(which(res.fec.g1.1<0.05))\nlegend(\"top\",paste(\"Number of proteins with p<0.05:\",n.sig,\"\\n Expected: 265\"),cex=0.7)\nhist(res.fec.all.1,100,ylim=ylim,main=\"Timepoint 1, All groups\",xlab=\"P-val for FEC effect\",cex.main=0.8)\nn.sig<-length(which(res.fec.all.1<0.05))\nlegend(\"top\",paste(\"Number of proteins with p<0.05:\",n.sig,\"\\n Expected: 265\"),cex=0.7)\nhist(res.fec.g1.2,100,ylim=ylim,main=\"Timepoint 2, Placebo_placebo group\",xlab=\"P-val for FEC effect\",cex.main=0.8)\nn.sig<-length(which(res.fec.g1.2<0.05))\nlegend(\"top\",paste(\"Number of proteins with p<0.05:\",n.sig,\"\\n Expected: 265\"),cex=0.7)\nhist(res.fec.all.2,100,ylim=ylim,main=\"Timepoint 2, All groups\",xlab=\"P-val for FEC effect\",cex.main=0.8)\nn.sig<-length(which(res.fec.all.2<0.05))\nlegend(\"top\",paste(\"Number of proteins with p<0.05:\",n.sig,\"\\n Expected: 265\"),cex=0.7)\nhist(res.fec.g1.3,100,ylim=ylim,main=\"Timepoint 3, Placebo_placebo group\",xlab=\"P-val for FEC effect\",cex.main=0.8)\nn.sig<-length(which(res.fec.g1.3<0.05))\nlegend(\"top\",paste(\"Number of proteins with p<0.05:\",n.sig,\"\\n Expected: 265\"),cex=0.7)\nhist(res.fec.all.3,100,ylim=ylim,main=\"Timepoint 3, All groups\",xlab=\"P-val for FEC effect\",cex.main=0.8)\nn.sig<-length(which(res.fec.all.3<0.05))\nlegend(\"top\",paste(\"Number of proteins with p<0.05:\",n.sig,\"\\n Expected: 265\"),cex=0.7)\nhist(res.fec.g1.4,100,ylim=ylim,main=\"Timepoint 4, Placebo_placebo group\",xlab=\"P-val for FEC effect\",cex.main=0.8)\nn.sig<-length(which(res.fec.g1.4<0.05))\nlegend(\"top\",paste(\"Number of proteins with p<0.05:\",n.sig,\"\\n Expected: 265\"),cex=0.7)\nhist(res.fec.all.4,100,ylim=ylim,main=\"Timepoint 4, All groups\",xlab=\"P-val for FEC effect\",cex.main=0.8)\nn.sig<-length(which(res.fec.all.4<0.05))\nlegend(\"top\",paste(\"Number of proteins with p<0.05:\",n.sig,\"\\n Expected: 265\"),cex=0.7)\nhist(res.fec.g1.5,100,ylim=ylim,main=\"Timepoint 5, Placebo_placebo group\",xlab=\"P-val for FEC effect\",cex.main=0.8)\nn.sig<-length(which(res.fec.g1.5<0.05))\nlegend(\"top\",paste(\"Number of proteins with p<0.05:\",n.sig,\"\\n Expected: 265\"),cex=0.7)\nhist(res.fec.all.5,100,ylim=ylim,main=\"Timepoint 5, All groups\",xlab=\"P-val for FEC effect\",cex.main=0.8)\nn.sig<-length(which(res.fec.all.5<0.05))\nlegend(\"top\",paste(\"Number of proteins with p<0.05:\",n.sig,\"\\n Expected: 265\"),cex=0.7)\ngraphics.off()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nH<-matrix(NA,5,5)\n\n\npar(mfrow=c(3,2))\nfor (k in 1:5){\n\thist(F.res[[k]],100)\n\t#print(convest(F.res[[k]]))\n\t#H[k,1]<-convest(F.res[[k]])\n\tH[k,1]<-mean(F.res[[k]])\n}\n\npar(mfrow=c(3,2))\nfor (k in 1:5){\n\thist(C.res[[k]],100)\n\t#print(convest(C.res[[k]]))\n\t#H[k,2]<-convest(C.res[[k]])\n\tH[k,2]<-mean(C.res[[k]])\n}\n\npar(mfrow=c(3,2))\nfor (k in 1:5){\n\thist(B.res[[k]],100)\n\t#print(convest(B.res[[k]]))\n\t#H[k,3]<-convest(B.res[[k]])\n\tH[k,3]<-mean(B.res[[k]])\n}\n\npar(mfrow=c(3,2))\nfor (k in 1:5){\n\thist(F.C.res[[k]],100)\n\t#print(convest(F.C.res[[k]]))\n\t#H[k,4]<-convest(F.C.res[[k]])\n\tH[k,4]<-mean(F.C.res[[k]])\n}\n\npar(mfrow=c(3,2))\nfor (k in 1:5){\n\thist(F.B.res[[k]],100)\n\t#print(convest(F.B.res[[k]]))\n\t#H[k,5]<-convest(F.B.res[[k]])\n\tH[k,5]<-mean(F.B.res[[k]])\n}\n\nrow.names(H)<-paste(\"Time\",1:5)\ncolnames(H)<-c(\"FEC\",\"Cand\",\"BB\",\"FEC:Cand\",\"FEC:BB\")\n\nmelted<-melt((1-H))\n\nlibrary(ggplot2)\nggplot(data = melted, aes(x=Var1, y=Var2, fill=value)) + \ngeom_tile()+\nscale_fill_continuous(low = \"white\", high = \"darkgrey\") \n\n\nhist(res.lm.3,100,main=\"Timepoint 3, Placebo-placebo, FEC (dose-response)\")\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.3,\"fdr\")<0.2))),cex=0.7)\nix<-which(tid==4 & group==1)\nres.lm.4<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.lm.4[j]<-coef(summary(glm(log(BB[ix,j])~fec[ix])))[2,4]\n}\nhist(res.lm.4,100,main=\"Timepoint 4, Placebo-placebo, FEC (dose-response)\")\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.4,\"fdr\")<0.2))),cex=0.7)\nix<-which(tid==5 & group==1)\nres.lm.5<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.lm.5[j]<-coef(summary(glm(log(BB[ix,j])~fec[ix])))[2,4]\n}\nhist(res.lm.5,100,main=\"Timepoint 5, Placebo-placebo, FEC (dose-response)\")\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.5,\"fdr\")<0.2))),cex=0.7)\ngraphics.off()\n\n\n\npdf(\"All groups, FEC (dose-response).pdf\")\npar(mfrow=c(3,2))\n\nix<-which(tid==1)\nres.lm.1<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.lm.1[j]<-coef(summary(glm(log(BB[ix,j])~fec[ix])))[2,4]\n}\nhist(res.lm.1,100,main=\"Timepoint 1, All groups, FEC (dose-response)\",cex.main=0.7)\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.1,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==2)\nres.lm.2<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.lm.2[j]<-coef(summary(glm(log(BB[ix,j])~fec[ix])))[2,4]\n}\nhist(res.lm.2,100,main=\"Timepoint 2, All groups, FEC (dose-response)\")\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.2,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==3)\nres.lm.3<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.lm.3[j]<-coef(summary(glm(log(BB[ix,j])~fec[ix])))[2,4]\n}\nhist(res.lm.3,100,main=\"Timepoint 3, All groups, FEC (dose-response)\")\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.3,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==4)\nres.lm.4<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.lm.4[j]<-coef(summary(glm(log(BB[ix,j])~fec[ix])))[2,4]\n}\nhist(res.lm.4,100,main=\"Timepoint 4, All groups, FEC (dose-response)\")\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.4,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==5)\nres.lm.5<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.lm.5[j]<-coef(summary(glm(log(BB[ix,j])~fec[ix])))[2,4]\n}\nhist(res.lm.5,100,main=\"Timepoint 5, All groups, FEC (dose-response)\")\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.5,\"fdr\")<0.2))),cex=0.7)\n\ngraphics.off()\n\npdf(\"Group 4, FEC (dose-response).pdf\")\npar(mfrow=c(3,2))\n\nix<-which(tid==1 & group==4)\nres.lm.1<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.lm.1[j]<-coef(summary(glm(log(BB[ix,j])~fec[ix])))[2,4]\n}\nhist(res.lm.1,100,main=\"Timepoint 1, Group 4, FEC (dose-response)\",cex.main=0.7)\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.1,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==2 & group==4)\nres.lm.2<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.lm.2[j]<-coef(summary(glm(log(BB[ix,j])~fec[ix])))[2,4]\n}\nhist(res.lm.2,100,main=\"Timepoint 2, Group 4, FEC (dose-response)\")\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.2,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==3 & group==4)\nres.lm.3<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.lm.3[j]<-coef(summary(glm(log(BB[ix,j])~fec[ix])))[2,4]\n}\nhist(res.lm.3,100,main=\"Timepoint 3, Group 4, FEC (dose-response)\")\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.3,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==4 & group==4)\nres.lm.4<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.lm.4[j]<-coef(summary(glm(log(BB[ix,j])~fec[ix])))[2,4]\n}\nhist(res.lm.4,100,main=\"Timepoint 4, Group 4, FEC (dose-response)\")\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.4,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==5 & group==4)\nres.lm.5<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.lm.5[j]<-coef(summary(glm(log(BB[ix,j])~fec[ix])))[2,4]\n}\nhist(res.lm.5,100,main=\"Timepoint 5, Group 4, FEC (dose-response)\")\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.lm.5,\"fdr\")<0.2))),cex=0.7)\n\ngraphics.off()\n\npdf(\"Group1, FEC (aov).pdf\")\npar(mfrow=c(3,2))\nix<-which(tid==1 & group==1)\nres.aov.1<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.aov.1[j]<-summary(aov(log(BB[ix,j])~factor(fec[ix])))[[1]][1,5]\n}\nhist(res.aov.1,100,main=\"Timepoint 1, Group 1, FEC (dose-response)\",cex.main=0.7)\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.aov.3,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==2 & group==1)\nres.aov.2<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.aov.2[j]<-summary(aov(log(BB[ix,j])~factor(fec[ix])))[[1]][1,5]\n}\nhist(res.aov.2,100,main=\"Timepoint 2, Group 1, FEC (dose-response)\",cex.main=0.7)\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.aov.2,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==3 & group==1)\nres.aov.3<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.aov.3[j]<-summary(aov(log(BB[ix,j])~factor(fec[ix])))[[1]][1,5]\n}\nhist(res.aov.3,100,main=\"Timepoint 3, Group 1, FEC (dose-response)\",cex.main=0.7)\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.aov.3,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==4 & group==1)\nres.aov.4<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.aov.4[j]<-summary(aov(log(BB[ix,j])~factor(fec[ix])))[[1]][1,5]\n}\nhist(res.aov.4,100,main=\"Timepoint 4, Group 1, FEC (dose-response)\",cex.main=0.7)\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.aov.4,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==5 & group==1)\nres.aov.5<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.aov.5[j]<-summary(aov(log(BB[ix,j])~factor(fec[ix])))[[1]][1,5]\n}\nhist(res.aov.5,100,main=\"Timepoint 5, Group 1, FEC (dose-response)\",cex.main=0.7)\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.aov.5,\"fdr\")<0.2))),cex=0.7)\n\ngraphics.off()\n\npdf(\"All groups, FEC (aov).pdf\")\npar(mfrow=c(3,2))\nix<-which(tid==1)\nres.aov.1<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.aov.1[j]<-summary(aov(log(BB[ix,j])~factor(fec[ix])))[[1]][1,5]\n}\nhist(res.aov.1,100,main=\"Timepoint 1, All groups, FEC (anova)\",cex.main=0.7)\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.aov.3,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==2)\nres.aov.2<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.aov.2[j]<-summary(aov(log(BB[ix,j])~factor(fec[ix])))[[1]][1,5]\n}\nhist(res.aov.2,100,main=\"Timepoint 2, All groups, FEC (anova)\",cex.main=0.7)\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.aov.2,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==3)\nres.aov.3<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.aov.3[j]<-summary(aov(log(BB[ix,j])~factor(fec[ix])))[[1]][1,5]\n}\nhist(res.aov.3,100,main=\"Timepoint 3, All groups, FEC (anova)\",cex.main=0.7)\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.aov.3,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==4)\nres.aov.4<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.aov.4[j]<-summary(aov(log(BB[ix,j])~factor(fec[ix])))[[1]][1,5]\n}\nhist(res.aov.4,100,main=\"Timepoint 4, All groups, FEC (anova)\",cex.main=0.7)\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.aov.4,\"fdr\")<0.2))),cex=0.7)\n\nix<-which(tid==5)\nres.aov.5<-rep(NA,ncol(BB))\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.aov.5[j]<-summary(aov(log(BB[ix,j])~factor(fec[ix])))[[1]][1,5]\n}\nhist(res.aov.5,100,main=\"Timepoint 5, All groups, FEC (anova)\",cex.main=0.7)\nlegend(\"top\",paste(\"No of sig proteins\",length(which(p.adjust(res.aov.5,\"fdr\")<0.2))),cex=0.7)\n\ngraphics.off()\n\n\n\n\n\n\ncolnames(res.glm)<-paste(\"fec\",1:15)\nres.glm<-data.frame(res.glm)\n\n\n\nix<-which(group==1)\n\nres.glm<-matrix(NA,ncol(BB),15)\nfor (j in 1:ncol(BB)){\n\tprint(j)\n\tres.glm[j,]<-coef(summary(glm(log(BB[ix,j])~as.factor(fec[ix])*as.factor(tid[ix]))))[,4]\n}\ncolnames(res.glm)<-paste(\"fec\",1:15)\nres.glm<-data.frame(res.glm)\n\nmid<-as.vector(t(as.matrix(res.glm[,8:15])))\nterm<-rep(8:15,each=ncol(BB))\nA<-data.frame(cbind(abs(mid),term))\ncolnames(A)[1]<-\"effect\"\n\nlibrary(ggplot2)\np<-ggplot(A,aes(factor(term),effect))\np+geom_violin(trim=FALSE)+geom_boxplot(width=0.2)\n\n\n\npar(mfrow=c(3,3))\nfor (j in 1:9)\nhist(res.glm[,j])\n\n\n\nix<-which(tid==1)\n\nplot(pca.res$x[ix,1],pca.res$x[ix,2],col=group[ix]+1)\n\n\nv<-strsplit(colnames(B),\"\\\\.\")\n#vv<-unlist(v)\n#length(vv)\n#w<-vv[seq(1,length(vv),3)]\nw<-lapply(v, `[[`, 1)\n\n\nix<-which(p.adjust(res.fec.g1.3,\"fdr\")<0.18)\no<-order(res.fec.g1.3)\nsyms<-unlist(w[o[1:200]])\nwrite.table(syms,file=\"fec-sig-g1.txt\",sep=\"\\t\",row.names=FALSE,col.names=FALSE,quote=FALSE)\n\nix<-which(res.fec.g1.3<0.05 & res.fec.all.3>0.5)\nsyms<-unlist(w[ix])\nwrite.table(syms,file=\"fec-sig-g1_notAll.txt\",sep=\"\\t\",row.names=FALSE,col.names=FALSE,quote=FALSE)\n\n\n\n\n\n",
    "created" : 1561638563741.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3361808693",
    "id" : "E1CCA8B2",
    "lastKnownWriteTime" : 1552635827,
    "last_content_update" : 1552635827,
    "path" : "~/prada/prada-cmd-3.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}