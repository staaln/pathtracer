v2<-which(P$Group==2 & P$Treatment=="V4")
for (i in 1:length(v1)) lines(c(3,4),c(BB[k,v1[i]],BB[k,v2[i]]))
lines(c(3,4),c(mean(BB[k,v1]),mean(BB[k,v2])),lwd=3,col="blue")
legend("topright",c(paste("p=",format(p[k],digits=1)),c(paste("fdr=",format(fdr[k],digits=1)))))
}
graphics.off()
dim(BB)
dim(BB.tpm)
dim(B.tpm)
dim(B)
genes
genes2[o[1:100]]
which(genes=="FAM124A")
B[5247,]
max(B[5274,])
max(B[5247,])
genes2[o[1:100]]
print(genes2[o[1:100]])
write.table(genes2[o[1:100]],file="genes_fish_vs_control.txt",sep="\t",row.names=FALSE,col.names=FALSE)
write.table(genes2[o[1:100]],file="genes_fish_vs_control.txt",sep="\t",row.names=FALSE,col.names=FALSE,quote=FALSE)
i<-3191
test<-glmer.nb(as.numeric(B[i,])~P$Group+P$Treatment+P$Group*P$Treatment+(1|P$ID),
control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=1e10)))
test<-glmer.nb(as.numeric(B[i,])~P$Group+P$Treatment+P$Group*P$Treatment+(1|P$ID),
control=glmerControl(optCtrl=list(maxfun=1e10)))
test
summary(test)
B.norm<-counts(dds,normalize=TRUE)
ixx<-which(apply(B.norm,1,median)>0)
B<-B.norm[ixx,]
nn<-nrow(B)
dim(B)
library(doMC)
registerDoMC(cores=4)
system.time({
p <- foreach(i = 1:nn, .combine=c) %dopar% {
write.table(i,file="ut_i.txt",append=TRUE)
test<-glmer.nb(as.numeric(B[i,])~P$Group+P$Treatment+P$Group*P$Treatment+(1|P$ID),
control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=1e10)))
print(i)
coef(summary(test))[4,4]
}
})
nn<-nrow(B)
dim(B)
library(doMC)
registerDoMC(cores=4)
system.time({
p <- foreach(i = 1:nn, .combine=c) %dopar% {
write.table(i,file="ut_i.txt",append=TRUE)
test<-glmer.nb(as.numeric(B[i,])~P$Group+P$Treatment+P$Group*P$Treatment+(1|P$ID),
control=glmerControl(optCtrl=list(maxfun=1e10)))
print(i)
coef(summary(test))[4,4]
}
})
fdr<-p.adjust(p,"fdr")
o<-order(p)
hist(p,100)
i
i<-44
test<-glmer.nb(as.numeric(B[i,])~P$Group+P$Treatment+P$Group*P$Treatment+(1|P$ID),
control=glmerControl(optCtrl=list(maxfun=1e10)))
i<-47
test<-glmer.nb(as.numeric(B[i,])~P$Group+P$Treatment+P$Group*P$Treatment+(1|P$ID),
control=glmerControl(optCtrl=list(maxfun=1e10)))
B[i,]
test<-glmer.nb(as.numeric(B[i,])~P$Group+P$Treatment+P$Group*P$Treatment+(1|P$ID),
control=glmerControl(optCtrl=list(maxfun=1e20)))
test<-glmer.nb(as.numeric(B[i,])~P$Group+P$Treatment+P$Group*P$Treatment+(1|P$ID),
control=glmerControl(optCtrl=list(maxfun=1e20)))
?glmerControl
test<-glmer.nb(as.numeric(B[i,])~P$Group+P$Treatment+P$Group*P$Treatment+(1|P$ID),
control=glmerControl(optimizer = "Nelder_Mead",optCtrl=list(maxfun=1e10)))
test<-glmer.nb(as.numeric(B[i,])~P$Group+P$Treatment+P$Group*P$Treatment+(1|P$ID),
control=glmerControl(optimizer = "bobyqa",optCtrl=list(maxfun=1e10)))
library(doMC)
registerDoMC(cores=4)
system.time({
p <- foreach(i = 1:nn, .combine=c) %dopar% {
write.table(i,file="ut_i.txt",append=TRUE)
test<-glmer.nb(as.numeric(B[i,])~P$Group+P$Treatment+P$Group*P$Treatment+(1|P$ID),
control=glmerControl(optimizer = "bobyqa",optCtrl=list(maxfun=1e20)))
print(i)
coef(summary(test))[4,4]
}
})
ix<-which(pheno$Group==1 | pheno$Group==2 | pheno$Group==3)
P<-pheno[ix,]
dds <- DESeqDataSetFromMatrix(countData = round(B.counts[,ix]),
colData = pheno[ix,],
design = ~ ID+Treatment)
dds<-estimateSizeFactors(dds)
B.norm<-counts(dds,normalize=TRUE)
ixx<-which(apply(B.norm,1,median)>0)
B<-B.norm[ixx,]
nn<-nrow(B)
dim(B)
test<-glmer.nb(as.numeric(B[i,])~P$Group+P$Treatment+P$Group*P$Treatment+(1|P$ID),
control=glmerControl(optimizer = "bobyqa",optCtrl=list(maxfun=1e20)))
i
library(doMC)
registerDoMC(cores=4)
system.time({
p <- foreach(i = 1:nn, .combine=c) %dopar% {
write.table(i,file="ut_i.txt",append=TRUE)
test<-glmer.nb(as.numeric(B[i,])~P$Group+P$Treatment+P$Group*P$Treatment+(1|P$ID),
control=glmerControl(optimizer = "bobyqa",optCtrl=list(maxfun=1e20)))
print(i)
coef(summary(test))[4,4]
}
})
coef(summary(test))
registerDoMC(cores=4)
write.table(i,file="ut_i.txt",append=TRUE)
system.time({
p <- foreach(i = 1:nn, .combine=c) %dopar% {
write.table(i,file="ut_i.txt",append=TRUE,row.names=FALSE,col.names=FALSE,quote=FALSE)
test<-glmer.nb(as.numeric(B[i,])~P$Group+P$Treatment+P$Group*P$Treatment+(1|P$ID),
control=glmerControl(optimizer = "bobyqa",optCtrl=list(maxfun=1e20)))
print(i)
coef(summary(test))[5:6,4]
}
})
write.table(i,file="ut_i.txt")
system.time({
p <- foreach(i = 1:nn, .combine=c) %dopar% {
write.table(i,file="ut_i.txt",append=TRUE,row.names=FALSE,col.names=FALSE,quote=FALSE)
test<-glmer.nb(as.numeric(B[i,])~P$Group+P$Treatment+P$Group*P$Treatment+(1|P$ID),
control=glmerControl(optimizer = "bobyqa",optCtrl=list(maxfun=1e20)))
print(i)
coef(summary(test))[5:6,4]
}
})
fdr<-p.adjust(p,"fdr")
o<-order(p)
hist(p)
hist(p,100)
hist(p[seq(1,length(p),2)],100)
hist(p[seq(2,length(p),2)],100)
p.ctrl.fish<-p[seq(1,length(p),2)]
p.krill.fish<-p[seq(1,length(p),2)]
fdr.ctrl.fish<-p.adjust(p.ctrl.fish,"fdr")
fdr.krill.fish<-p.adjust(p.krill.fish,"fdr")
o<-order(p.krill.fish)
hist(p,100)
#genes2<-genes[(1:12000)[-c(3191)]]
genes2<-genes
#BB<-B[(1:12000)[-c(3191)],]
BB<-B
o<-order(p.ctrl.fish)
pdf("Gene-plots-top100-fish_vs_control-glmernb.pdf")
for (i in 1:100){
k<-o[i]
v1<-which(P$Group==1 & P$Treatment=="V0")
v2<-which(P$Group==1 & P$Treatment=="V4")
plot(c(1,2),c(BB[k,v1[1]],BB[k,v2[1]]),ylim=c(0,max(BB[k,])),xlim=c(0.5,4.5),
main=paste("Gene:",as.character(genes2[k])),xlab="",ylab="Normalized count",xaxt="n",pch="")
par(cex=0.7)
axis(side=1,at=1:4,labels=c("Fish, before","Fish, after","Control, before","Control, after"),
las=2)
par(cex=1)
for (i in 1:length(v1)) lines(c(1,2),c(BB[k,v1[i]],BB[k,v2[i]]))
lines(c(1,2),c(mean(BB[k,v1]),mean(BB[k,v2])),lwd=3,col="blue")
v1<-which(P$Group==2 & P$Treatment=="V0")
v2<-which(P$Group==2 & P$Treatment=="V4")
for (i in 1:length(v1)) lines(c(3,4),c(BB[k,v1[i]],BB[k,v2[i]]))
lines(c(3,4),c(mean(BB[k,v1]),mean(BB[k,v2])),lwd=3,col="blue")
legend("topright",c(paste("p=",format(p[k],digits=1)),c(paste("fdr=",format(fdr[k],digits=1)))))
}
graphics.off()
hist(p.ctrl.fish,100)
hist(p.ctrl.fish,100)
hist(p.krill.fish,100)
p.ctrl.fish<-p[seq(1,length(p),2)]
p.krill.fish<-p[seq(2,length(p),2)]
fdr.ctrl.fish<-p.adjust(p.ctrl.fish,"fdr")
fdr.krill.fish<-p.adjust(p.krill.fish,"fdr")
o<-order(p.ctrl.fish)
hist(p.ctrl.fish,100)
hist(p.krill.fish,100)
genes2<-genes
#BB<-B[(1:12000)[-c(3191)],]
BB<-B
pdf("Gene-plots-top100-fish_vs_control-glmernb.pdf")
for (i in 1:100){
k<-o[i]
v1<-which(P$Group==1 & P$Treatment=="V0")
v2<-which(P$Group==1 & P$Treatment=="V4")
plot(c(1,2),c(BB[k,v1[1]],BB[k,v2[1]]),ylim=c(0,max(BB[k,])),xlim=c(0.5,4.5),
main=paste("Gene:",as.character(genes2[k])),xlab="",ylab="Normalized count",xaxt="n",pch="")
par(cex=0.7)
axis(side=1,at=1:4,labels=c("Fish, before","Fish, after","Control, before","Control, after"),
las=2)
par(cex=1)
for (i in 1:length(v1)) lines(c(1,2),c(BB[k,v1[i]],BB[k,v2[i]]))
lines(c(1,2),c(mean(BB[k,v1]),mean(BB[k,v2])),lwd=3,col="blue")
v1<-which(P$Group==2 & P$Treatment=="V0")
v2<-which(P$Group==2 & P$Treatment=="V4")
for (i in 1:length(v1)) lines(c(3,4),c(BB[k,v1[i]],BB[k,v2[i]]))
lines(c(3,4),c(mean(BB[k,v1]),mean(BB[k,v2])),lwd=3,col="blue")
legend("topright",c(paste("p=",format(p[k],digits=1)),c(paste("fdr=",format(fdr[k],digits=1)))))
}
graphics.off()
pdf("Gene-plots-top100-fish_vs_control-glmernb.pdf")
for (i in 1:100){
k<-o[i]
v1<-which(P$Group==1 & P$Treatment=="V0")
v2<-which(P$Group==1 & P$Treatment=="V4")
plot(c(1,2),c(BB[k,v1[1]],BB[k,v2[1]]),ylim=c(0,max(BB[k,])),xlim=c(0.5,4.5),
main=paste("Gene:",as.character(genes2[k])),xlab="",ylab="Normalized count",xaxt="n",pch="")
par(cex=0.7)
axis(side=1,at=1:4,labels=c("Fish, before","Fish, after","Control, before","Control, after"),
las=2)
par(cex=1)
for (i in 1:length(v1)) lines(c(1,2),c(BB[k,v1[i]],BB[k,v2[i]]))
lines(c(1,2),c(mean(BB[k,v1]),mean(BB[k,v2])),lwd=3,col="blue")
v1<-which(P$Group==2 & P$Treatment=="V0")
v2<-which(P$Group==2 & P$Treatment=="V4")
for (i in 1:length(v1)) lines(c(3,4),c(BB[k,v1[i]],BB[k,v2[i]]))
lines(c(3,4),c(mean(BB[k,v1]),mean(BB[k,v2])),lwd=3,col="blue")
legend("topright",c(paste("p=",format(p.ctrl.fish[k],digits=1)),c(paste("fdr=",format(fdr.ctrl.fish[k],digits=1)))))
}
graphics.off()
write.table(genes[o[1:100]],file="sig-genes-fish-vs-ctrl.txt",sep="\t",row.names=TRUE,col.names=TRUE,quote=TRUE)
write.table(genes[o[1:100]],file="sig-genes-fish-vs-ctrl.txt",sep="\t",row.names=FALSE,col.names=FALSE,quote=FALSE)
fdr.ctrl.fish[1:1000]
fdr.ctrl.fish[1:100]
fdr.ctrl.fish[o[1:100]]
fdr.ctrl.fish[o[1:200]]
write.table(genes[o[1:500]],file="sig-genes-fish-vs-ctrl.txt",sep="\t",row.names=FALSE,col.names=FALSE,quote=FALSE)
fdr.ctrl.fish[o[500]]
fdr.ctrl.fish[o[200]]
fdr.ctrl.fish[o[150]]
14120+65300+19100+750*15+31200
(14120+65300+19100+750*15+31200)*1.25
o<-order(p.fish.krill)
o<-order(p.krill.fish)
pdf("Gene-plots-top100-krill_vs_fish-glmernb.pdf")
o<-order(p.krill.fish)
for (i in 1:100){
k<-o[i]
v1<-which(P$Group==1 & P$Treatment=="V0")
v2<-which(P$Group==1 & P$Treatment=="V4")
plot(c(1,2),c(B[k,v1[1]],B[k,v2[1]]),ylim=c(0,max(B[k,])),xlim=c(0.5,4.5),
main=paste("Gene:",as.character(genes2[k])),xlab="",ylab="Normalized count",xaxt="n",pch="")
par(cex=0.7)
axis(side=1,at=1:4,labels=c("Fish, before","Fish, after","Control, before","Control, after"),
las=2)
par(cex=1)
for (i in 1:length(v1)) lines(c(1,2),c(B[k,v1[i]],B[k,v2[i]]))
lines(c(1,2),c(mean(B[k,v1]),mean(B[k,v2])),lwd=3,col="blue")
v1<-which(P$Group==2 & P$Treatment=="V0")
v2<-which(P$Group==2 & P$Treatment=="V4")
for (i in 1:length(v1)) lines(c(3,4),c(B[k,v1[i]],B[k,v2[i]]))
lines(c(3,4),c(mean(B[k,v1]),mean(B[k,v2])),lwd=3,col="blue")
legend("topright",c(paste("p=",format(p.krill.fish[k],digits=1)),c(paste("fdr=",format(fdr.krill.fish[k],digits=1)))))
}
graphics.off()
pdf("Gene-plots-top100-krill_vs_fish-glmernb.pdf")
o<-order(p.krill.fish)
for (i in 1:100){
k<-o[i]
v1<-which(P$Group==1 & P$Treatment=="V0")
v2<-which(P$Group==1 & P$Treatment=="V4")
plot(c(1,2),c(B[k,v1[1]],B[k,v2[1]]),ylim=c(0,max(B[k,])),xlim=c(0.5,4.5),
main=paste("Gene:",as.character(genes[k])),xlab="",ylab="Normalized count",xaxt="n",pch="")
par(cex=0.7)
axis(side=1,at=1:4,labels=c("Fish, before","Fish, after","Control, before","Control, after"),
las=2)
par(cex=1)
for (i in 1:length(v1)) lines(c(1,2),c(B[k,v1[i]],B[k,v2[i]]))
lines(c(1,2),c(mean(B[k,v1]),mean(B[k,v2])),lwd=3,col="blue")
v1<-which(P$Group==2 & P$Treatment=="V0")
v2<-which(P$Group==2 & P$Treatment=="V4")
for (i in 1:length(v1)) lines(c(3,4),c(B[k,v1[i]],B[k,v2[i]]))
lines(c(3,4),c(mean(B[k,v1]),mean(B[k,v2])),lwd=3,col="blue")
legend("topright",c(paste("p=",format(p.krill.fish[k],digits=1)),c(paste("fdr=",format(fdr.krill.fish[k],digits=1)))))
}
graphics.off()
p.ctrl.fish<-p[seq(1,length(p),2)]
p.krill.fish<-p[seq(2,length(p),2)]
fdr.ctrl.fish<-p.adjust(p.ctrl.fish,"fdr")
fdr.krill.fish<-p.adjust(p.krill.fish,"fdr")
o<-order(p.ctrl.fish)
hist(p.ctrl.fish,100)
hist(p.krill.fish,100)
#genes2<-genes[(1:12000)[-c(3191)]]
genes2<-genes
#BB<-B[(1:12000)[-c(3191)],]
BB<-B
o<-order(p.ctrl.fish)
pdf("Gene-plots-top100-fish_vs_control-glmernb.pdf")
for (i in 1:100){
k<-o[i]
v1<-which(P$Group==1 & P$Treatment=="V0")
v2<-which(P$Group==1 & P$Treatment=="V4")
plot(c(1,2),c(BB[k,v1[1]],BB[k,v2[1]]),ylim=c(0,max(BB[k,])),xlim=c(0.5,4.5),
main=paste("Gene:",as.character(genes2[k])),xlab="",ylab="Normalized count",xaxt="n",pch="")
par(cex=0.7)
axis(side=1,at=1:4,labels=c("Fish, before","Fish, after","Control, before","Control, after"),
las=2)
par(cex=1)
for (i in 1:length(v1)) lines(c(1,2),c(BB[k,v1[i]],BB[k,v2[i]]))
lines(c(1,2),c(mean(BB[k,v1]),mean(BB[k,v2])),lwd=3,col="blue")
v1<-which(P$Group==2 & P$Treatment=="V0")
v2<-which(P$Group==2 & P$Treatment=="V4")
for (i in 1:length(v1)) lines(c(3,4),c(BB[k,v1[i]],BB[k,v2[i]]))
lines(c(3,4),c(mean(BB[k,v1]),mean(BB[k,v2])),lwd=3,col="blue")
legend("topright",c(paste("p=",format(p.ctrl.fish[k],digits=1)),c(paste("fdr=",format(fdr.ctrl.fish[k],digits=1)))))
}
graphics.off()
write.table(genes[o[1:500]],file="sig-genes-fish-vs-ctrl.txt",sep="\t",row.names=FALSE,col.names=FALSE,quote=FALSE)
#w1<-B[k,v2]-B[k,v1]
#v1<-which(P$Group==2 & P$Treatment=="V0")
#v2<-which(P$Group==2 & P$Treatment=="V4")
#w2<-B[k,v2]-B[k,v1]
#ww<-c(w1,w2)
#plot(rep(1,length(w1)),w1,xlim=c(0,3),ylim=c(min(ww),max(ww)),
#   xaxt="n",pch=20,col="red",main=paste("Gene symbol:",as.character(genes[k])),xlab="",ylab="Expression value\n after-before")
#points(rep(2,length(w2)),w2,pch=20)
#axis(side=1,at=c(1,2),labels=c("Group1","Group2"))
#legend("topright",c(paste("p=",format(p[k],digits=1)),c(paste("fdr=",format(fdr[k],digits=1)))))
#}
#graphics.off()
pdf("Gene-plots-top100-krill_vs_fish-glmernb.pdf")
o<-order(p.krill.fish)
for (i in 1:100){
k<-o[i]
v1<-which(P$Group==1 & P$Treatment=="V0")
v2<-which(P$Group==1 & P$Treatment=="V4")
plot(c(1,2),c(B[k,v1[1]],B[k,v2[1]]),ylim=c(0,max(B[k,])),xlim=c(0.5,4.5),
main=paste("Gene:",as.character(genes[k])),xlab="",ylab="Normalized count",xaxt="n",pch="")
par(cex=0.7)
axis(side=1,at=1:4,labels=c("Fish, before","Fish, after","Control, before","Control, after"),
las=2)
par(cex=1)
for (i in 1:length(v1)) lines(c(1,2),c(B[k,v1[i]],B[k,v2[i]]))
lines(c(1,2),c(mean(B[k,v1]),mean(B[k,v2])),lwd=3,col="blue")
v1<-which(P$Group==2 & P$Treatment=="V0")
v2<-which(P$Group==2 & P$Treatment=="V4")
for (i in 1:length(v1)) lines(c(3,4),c(B[k,v1[i]],B[k,v2[i]]))
lines(c(3,4),c(mean(B[k,v1]),mean(B[k,v2])),lwd=3,col="blue")
legend("topright",c(paste("p=",format(p.krill.fish[k],digits=1)),c(paste("fdr=",format(fdr.krill.fish[k],digits=1)))))
}
graphics.off()
p.ctrl.fish<-p[seq(1,length(p),2)]
p.krill.fish<-p[seq(2,length(p),2)]
fdr.ctrl.fish<-p.adjust(p.ctrl.fish,"fdr")
fdr.krill.fish<-p.adjust(p.krill.fish,"fdr")
o<-order(p.ctrl.fish)
hist(p.ctrl.fish,100)
hist(p.krill.fish,100)
#genes2<-genes[(1:12000)[-c(3191)]]
genes2<-genes
#BB<-B[(1:12000)[-c(3191)],]
BB<-B
o<-order(p.ctrl.fish)
pdf("Gene-plots-top100-fish_vs_control-glmernb.pdf")
for (i in 1:100){
k<-o[i]
v1<-which(P$Group==1 & P$Treatment=="V0")
v2<-which(P$Group==1 & P$Treatment=="V4")
plot(c(1,2),c(BB[k,v1[1]],BB[k,v2[1]]),ylim=c(0,max(BB[k,])),xlim=c(0.5,4.5),
main=paste("Gene:",as.character(genes2[k])),xlab="",ylab="Normalized count",xaxt="n",pch="")
par(cex=0.7)
axis(side=1,at=1:4,labels=c("Fish, before","Fish, after","Control, before","Control, after"),
las=2)
par(cex=1)
for (i in 1:length(v1)) lines(c(1,2),c(BB[k,v1[i]],BB[k,v2[i]]))
lines(c(1,2),c(mean(BB[k,v1]),mean(BB[k,v2])),lwd=3,col="blue")
v1<-which(P$Group==2 & P$Treatment=="V0")
v2<-which(P$Group==2 & P$Treatment=="V4")
for (i in 1:length(v1)) lines(c(3,4),c(BB[k,v1[i]],BB[k,v2[i]]))
lines(c(3,4),c(mean(BB[k,v1]),mean(BB[k,v2])),lwd=3,col="blue")
legend("topright",c(paste("p=",format(p.ctrl.fish[k],digits=1)),c(paste("fdr=",format(fdr.ctrl.fish[k],digits=1)))))
}
graphics.off()
write.table(genes[o[1:500]],file="sig-genes-fish-vs-ctrl.txt",sep="\t",row.names=FALSE,col.names=FALSE,quote=FALSE)
#w1<-B[k,v2]-B[k,v1]
#v1<-which(P$Group==2 & P$Treatment=="V0")
#v2<-which(P$Group==2 & P$Treatment=="V4")
#w2<-B[k,v2]-B[k,v1]
#ww<-c(w1,w2)
#plot(rep(1,length(w1)),w1,xlim=c(0,3),ylim=c(min(ww),max(ww)),
#   xaxt="n",pch=20,col="red",main=paste("Gene symbol:",as.character(genes[k])),xlab="",ylab="Expression value\n after-before")
#points(rep(2,length(w2)),w2,pch=20)
#axis(side=1,at=c(1,2),labels=c("Group1","Group2"))
#legend("topright",c(paste("p=",format(p[k],digits=1)),c(paste("fdr=",format(fdr[k],digits=1)))))
#}
#graphics.off()
pdf("Gene-plots-top100-krill_vs_fish-glmernb.pdf")
o<-order(p.krill.fish)
for (i in 1:100){
k<-o[i]
v1<-which(P$Group==1 & P$Treatment=="V0")
v2<-which(P$Group==1 & P$Treatment=="V4")
plot(c(1,2),c(B[k,v1[1]],B[k,v2[1]]),ylim=c(0,max(B[k,])),xlim=c(0.5,4.5),
main=paste("Gene:",as.character(genes[k])),xlab="",ylab="Normalized count",xaxt="n",pch="")
par(cex=0.7)
axis(side=1,at=1:4,labels=c("Fish, before","Fish, after","Control, before","Control, after"),
las=2)
par(cex=1)
for (i in 1:length(v1)) lines(c(1,2),c(B[k,v1[i]],B[k,v2[i]]))
lines(c(1,2),c(mean(B[k,v1]),mean(B[k,v2])),lwd=3,col="blue")
v1<-which(P$Group==2 & P$Treatment=="V0")
v2<-which(P$Group==2 & P$Treatment=="V4")
for (i in 1:length(v1)) lines(c(3,4),c(B[k,v1[i]],B[k,v2[i]]))
lines(c(3,4),c(mean(B[k,v1]),mean(B[k,v2])),lwd=3,col="blue")
legend("topright",c(paste("p=",format(p.krill.fish[k],digits=1)),c(paste("fdr=",format(fdr.krill.fish[k],digits=1)))))
}
graphics.off()
p.ctrl.fish[1:10]
p.fish.krill[1:10]
p.krill.fish[1:10]
o<-order(p.ctrl.fish)
pdf("Gene-plots-top100-fish_vs_control-glmernb.pdf")
for (i in 1:100){
k<-o[i]
v1<-which(P$Group==1 & P$Treatment=="V0")
v2<-which(P$Group==1 & P$Treatment=="V4")
plot(c(1,2),c(BB[k,v1[1]],BB[k,v2[1]]),ylim=c(0,max(BB[k,])),xlim=c(0.5,4.5),
main=paste("Gene:",as.character(genes2[k])),xlab="",ylab="Normalized count",xaxt="n",pch="")
par(cex=0.7)
axis(side=1,at=1:4,labels=c("Fish, before","Fish, after","Control, before","Control, after"),
las=2)
par(cex=1)
for (i in 1:length(v1)) lines(c(1,2),c(BB[k,v1[i]],BB[k,v2[i]]))
lines(c(1,2),c(mean(BB[k,v1]),mean(BB[k,v2])),lwd=3,col="blue")
v1<-which(P$Group==2 & P$Treatment=="V0")
v2<-which(P$Group==2 & P$Treatment=="V4")
for (i in 1:length(v1)) lines(c(3,4),c(BB[k,v1[i]],BB[k,v2[i]]))
lines(c(3,4),c(mean(BB[k,v1]),mean(BB[k,v2])),lwd=3,col="blue")
legend("topright",c(paste("p=",format(p.ctrl.fish[k],digits=1)),c(paste("fdr=",format(fdr.ctrl.fish[k],digits=1)))))
}
graphics.off()
o[1]
pdf("Gene-plots-top100-krill_vs_fish-glmernb.pdf")
o<-order(p.krill.fish)
for (i in 1:100){
k<-o[i]
v1<-which(P$Group==1 & P$Treatment=="V0")
v2<-which(P$Group==1 & P$Treatment=="V4")
plot(c(1,2),c(B[k,v1[1]],B[k,v2[1]]),ylim=c(0,max(B[k,])),xlim=c(0.5,4.5),
main=paste("Gene:",as.character(genes[k])),xlab="",ylab="Normalized count",xaxt="n",pch="")
par(cex=0.7)
axis(side=1,at=1:4,labels=c("Fish, before","Fish, after","Control, before","Control, after"),
las=2)
par(cex=1)
for (i in 1:length(v1)) lines(c(1,2),c(B[k,v1[i]],B[k,v2[i]]))
lines(c(1,2),c(mean(B[k,v1]),mean(B[k,v2])),lwd=3,col="blue")
v1<-which(P$Group==2 & P$Treatment=="V0")
v2<-which(P$Group==2 & P$Treatment=="V4")
for (i in 1:length(v1)) lines(c(3,4),c(B[k,v1[i]],B[k,v2[i]]))
lines(c(3,4),c(mean(B[k,v1]),mean(B[k,v2])),lwd=3,col="blue")
legend("topright",c(paste("p=",format(p.krill.fish[k],digits=1)),c(paste("fdr=",format(fdr.krill.fish[k],digits=1)))))
}
graphics.off()
o[1]
o<-order(p.krill.fish)
o[1]
o<-order(p.ctrl.fish)
o[1]
res <- Kappa.test(matrix(c(20, 10, 5, 15), 2, 2))
str(res)
print(res)
install.packages("fmsb")
library(fmsb)
res <- Kappa.test(matrix(c(20, 10, 5, 15), 2, 2))
str(res)
print(res)
res <- Kappa.test(matrix(c(20, 10, 5, 15), 2, 2),matrix(c(20, 12, 15, 15), 2, 2))
str(res)
print(res)
res <- Kappa.test(x=matrix(c(20, 10, 5, 15), 2, 2),y=matrix(c(20, 12, 15, 15), 2, 2))
str(res)
print(res)
res <- Kappa.test(x=matrix(c(20, 10, 5, 15), 2, 2),y=matrix(c(10, 12, 15, 15), 2, 2))
str(res)
print(res)
data(anxiety)
install.packages("irr")
library(irr)
data(anxiety)
data(video)
video
data(anxiety)
anxiety
iota(ratings, scaledata = c("quantitative","nominal"),
standardize = FALSE)
data("ratings")
photo <- list()
photo[[1]] <- cbind(c( 71, 73, 86, 59, 71),  # weight ratings
c( 74, 80,101, 62, 83),
c( 76, 80, 93, 66, 77))
photo[[2]] <- cbind(c(166,160,187,161,172),  # height rating
c(171,170,174,163,182),
c(171,165,185,162,181))
iota(photo)
data(diagnoses)
iota(list(diagnoses))
kappam.fleiss(diagnoses, exact=TRUE)
photo[[1]]
iota(photo)
kappam.fleiss(photo)
diagnoses
list(diagnoses)
?kappam.fleiss
?iota
?iota
photo
iota(photo)
